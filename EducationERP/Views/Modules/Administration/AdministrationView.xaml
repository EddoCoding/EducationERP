<UserControl x:Class="EducationERP.Views.Modules.Administration.AdministrationView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:EducationERP.Views.Modules.Administration"
             mc:Ignorable="d" d:DesignHeight="450" d:DesignWidth="800" FontFamily="Calibri">
    <UserControl.Resources>
        <Style x:Key="ExpanderDownHeader" TargetType="ToggleButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Border Padding="10" Background="#FFD700">
                            <Grid Background="Transparent" SnapsToDevicePixels="False">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                </Grid.ColumnDefinitions>

                                <ContentPresenter Grid.Column="0" HorizontalAlignment="Left" Margin="4,0,0,0" RecognizesAccessKey="True" 
                                                  SnapsToDevicePixels="True" VerticalAlignment="Center"/>
                                <Path x:Name="arrow" Grid.Column="1" Data="M 1,1.5 L 4.5,5 L 8,1.5" HorizontalAlignment="Center" Stroke="Black" 
                                      SnapsToDevicePixels="false" StrokeThickness="2" VerticalAlignment="Center"/>
                            
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="true">
                                <Setter Property="Data" TargetName="arrow" Value="M 1,4.5  L 4.5,1  L 8,4.5"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="Stroke" TargetName="arrow" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true">
                                <Setter Property="Stroke" TargetName="arrow" Value="Black"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ExpanderUserManagement" TargetType="Expander">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Expander">
                        <Border SnapsToDevicePixels="true">
                            <DockPanel>
                                <ToggleButton x:Name="HeaderSite" ContentTemplate="{TemplateBinding HeaderTemplate}" Content="{TemplateBinding Header}" 
                                              ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}" DockPanel.Dock="Top" FontStretch="{TemplateBinding FontStretch}" 
                                              Foreground="{TemplateBinding Foreground}" FontStyle="{TemplateBinding FontStyle}" FontFamily="{TemplateBinding FontFamily}" 
                                              FontWeight="{TemplateBinding FontWeight}"  FontSize="{TemplateBinding FontSize}" HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                              IsChecked="{Binding IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource Mode=TemplatedParent}}" Margin="1" MinWidth="0" 
                                              MinHeight="0" Padding="{TemplateBinding Padding}" Style="{StaticResource ExpanderDownHeader}" 
                                              VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}"/>
                                <ContentPresenter x:Name="ExpandSite" DockPanel.Dock="Bottom" Focusable="false" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                                  Margin="{TemplateBinding Padding}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}" Visibility="Collapsed"/>
                            </DockPanel>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsExpanded" Value="true">
                                <Setter Property="Visibility" TargetName="ExpandSite" Value="Visible"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ColumnHeaderUsers" TargetType="DataGridColumnHeader">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridColumnHeader">
                        <Border BorderThickness="1" BorderBrush="Gray" Background="{TemplateBinding Background}">
                            <ContentPresenter HorizontalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="ToggleButton" TargetType="ToggleButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ToggleButton">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="{Binding FullName}" VerticalAlignment="Center" Margin="10,5"/>
                            <TextBlock Grid.Column="1" Text="{Binding Identifier}" VerticalAlignment="Center" Margin="10,5"/>
                            <TextBlock Grid.Column="2" Text="{Binding Password}" VerticalAlignment="Center" Margin="10,5"/>
                            <TextBlock Grid.Column="3" Text="{Binding Role}" VerticalAlignment="Center" Margin="10,5"/>
                            <TextBlock Grid.Column="4" Text="{Binding SubRole}" VerticalAlignment="Center" Margin="10,5"/>

                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <Style x:Key="UserRowStyle" TargetType="DataGridRow">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="DataGridRow">
                        <Border Margin="0,1" BorderThickness="0,0,0,1" BorderBrush="LightGray" Background="{TemplateBinding Background}">
                            <Grid>
                                <ToggleButton IsChecked="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected, Mode=TwoWay}"
                                  HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" Style="{StaticResource ToggleButton}"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect Color="LightGray" ShadowDepth="2"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="WhiteSmoke"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>

    <Grid Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <TextBlock Grid.Row="0" HorizontalAlignment="Right" FontSize="16" Text="Администрирование" Margin="0,10,15,5" Foreground="Gray"/>
        <ScrollViewer Grid.Row="1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Expander Grid.Row="1" FontSize="16" Style="{StaticResource ExpanderUserManagement}" Header="Управление пользователями" Margin="10,5,10,0" Padding="2,0">
                    <Grid Background="White">
                        <Grid.Effect>
                            <DropShadowEffect Color="LightGray" ShadowDepth="0"/>
                        </Grid.Effect>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0" Margin="10">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0" Text="Список пользователей"/>
                            <TextBox Grid.Column="1" Margin="10,0,0,0" Text="Поиск пользователей"
                                     Foreground="Gray" FontSize="14" VerticalContentAlignment="Center"/>
                        </Grid>

                        <DataGrid Grid.Row="1" Margin="10,0" Height="350" Background="White" ItemsSource="{Binding UserViewModel.Users}" AutoGenerateColumns="False"
                                  SelectedItem="{Binding UserViewModel.SelectedUser}" ColumnHeaderStyle="{StaticResource ColumnHeaderUsers}" CanUserAddRows="False"
                                  CanUserDeleteRows="False" CanUserResizeRows="False" RowHeaderWidth="0" BorderBrush="Gray" BorderThickness="1,0,1,1" SelectionMode="Single" 
                                  CanUserReorderColumns="False" CanUserResizeColumns="False" RowStyle="{StaticResource UserRowStyle}">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="ФИО" Width="*" IsReadOnly="True"/>
                                <DataGridTextColumn Header="Идентификатор" Width="*" IsReadOnly="True"/>
                                <DataGridTextColumn Header="Пароль" Width="*" IsReadOnly="True"/>
                                <DataGridTextColumn Header="Роли" Width="*" IsReadOnly="True"/>
                                <DataGridTextColumn Header="Под роли" Width="*" IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <StackPanel Grid.Row="2" Background="White" Margin="10" Orientation="Horizontal" HorizontalAlignment="Right" RenderOptions.BitmapScalingMode="NearestNeighbor">
                            <StackPanel.Effect>
                                <DropShadowEffect Opacity="0.3" ShadowDepth="1"/>
                            </StackPanel.Effect>

                            <Button Content="/Common/Images/addUser.png" Style="{StaticResource ButtonImage}" Command="{Binding UserViewModel.OpenWindowAddUserCommand}"
                                    Height="23" Width="23" VerticalAlignment="Top" Margin="10" ToolTip="Добавить пользователя в систему"/>

                            <Button Content="/Common/Images/changeUser.png" Style="{StaticResource ButtonImage}" Command="{Binding UserViewModel.ChangeUserCommand}"
                                    Height="23" Width="23" VerticalAlignment="Top" Margin="10" ToolTip="Изменить данные пользователя системы"/>

                            <Button Content="/Common/Images/deleteUser.png" Style="{StaticResource ButtonImage}" Command="{Binding UserViewModel.DeleteUserCommand}"
                                    Height="23" Width="23" VerticalAlignment="Top" Margin="10" ToolTip="Удалить пользователя из системы"/>

                            <Button Content="/Common/Images/update.png" Style="{StaticResource ButtonImage}" Command="{Binding UserViewModel.UpdateUserCommand}"
                                    Height="23" Width="23" VerticalAlignment="Top" Margin="10" ToolTip="Обновить список пользователей"/>

                        </StackPanel>

                    </Grid>
                </Expander>

                <Expander Grid.Row="2" FontSize="16" Style="{StaticResource ExpanderUserManagement}" Header="Настройка модуля - Учебный отдел" Margin="10,5,10,0" Padding="2,0"/>

                <Expander Grid.Row="3" FontSize="16" Style="{StaticResource ExpanderUserManagement}" Header="Настройка модуля - Приёмная кампания" Margin="10,5,10,0" Padding="2,0"/>

                <Expander Grid.Row="4" FontSize="16" Style="{StaticResource ExpanderUserManagement}" Header="Настройка модуля - Деканат" Margin="10,5,10,0" Padding="2,0"/>

                <Expander Grid.Row="5" FontSize="16" Style="{StaticResource ExpanderUserManagement}" Header="Настройка базы данны" Margin="10,5,10,0" Padding="2,0">
                    <Grid Background="White">
                        <Grid.Effect>
                            <DropShadowEffect Color="LightGray" ShadowDepth="0"/>
                        </Grid.Effect>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0" Background="White" Margin="10,10,10,0">
                            <Grid.Effect>
                                <DropShadowEffect Opacity="0.3" ShadowDepth="1"/>
                            </Grid.Effect>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Host" Style="{StaticResource defaultLabel}" Foreground="Gray" FontSize="14" Margin="10,0,0,0"/>
                            <TextBox Grid.Row="1" Text="{Binding SettingBDViewModel.Host}" Style="{StaticResource defaultTextBox}" Margin="10,0,10,10"/>
                        </Grid>

                        <Grid Grid.Row="1" Background="White" Margin="10,10,10,0">
                            <Grid.Effect>
                                <DropShadowEffect Opacity="0.3" ShadowDepth="1"/>
                            </Grid.Effect>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Port" Style="{StaticResource defaultLabel}" Foreground="Gray" FontSize="14" Margin="10,0,0,0"/>
                            <TextBox Grid.Row="1" Text="{Binding SettingBDViewModel.Port}" Style="{StaticResource defaultTextBox}" Margin="10,0,10,10"/>
                        </Grid>

                        <Grid Grid.Row="2" Background="White" Margin="10,10,10,0">
                            <Grid.Effect>
                                <DropShadowEffect Opacity="0.3" ShadowDepth="1"/>
                            </Grid.Effect>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Username" Style="{StaticResource defaultLabel}" Foreground="Gray" FontSize="14" Margin="10,0,0,0"/>
                            <TextBox Grid.Row="1" Text="{Binding SettingBDViewModel.Username}" Style="{StaticResource defaultTextBox}" Margin="10,0,10,10"/>
                        </Grid>

                        <Grid Grid.Row="3" Background="White" Margin="10,10,10,0">
                            <Grid.Effect>
                                <DropShadowEffect Opacity="0.3" ShadowDepth="1"/>
                            </Grid.Effect>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Password" Style="{StaticResource defaultLabel}" Foreground="Gray" FontSize="14" Margin="10,0,0,0"/>
                            <TextBox Grid.Row="1" Text="{Binding SettingBDViewModel.Password}" Style="{StaticResource defaultTextBox}" Margin="10,0,10,10"/>
                        </Grid>

                        <Grid Grid.Row="4" Background="White" Margin="10,10,10,0">
                            <Grid.Effect>
                                <DropShadowEffect Opacity="0.3" ShadowDepth="1"/>
                            </Grid.Effect>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Database" Style="{StaticResource defaultLabel}" Foreground="Gray" FontSize="14" Margin="10,0,0,0"/>
                            <TextBox Grid.Row="1" Text="{Binding SettingBDViewModel.Database}" Style="{StaticResource defaultTextBox}" Margin="10,0,10,10"/>
                        </Grid>

                        <Grid Grid.Row="5" Background="White" Margin="10,10,10,0">
                            <Grid.Effect>
                                <DropShadowEffect Opacity="0.3" ShadowDepth="1"/>
                            </Grid.Effect>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <Label Grid.Row="0" Content="Путь до директории временного хранения данных" Style="{StaticResource defaultLabel}" Foreground="Gray" FontSize="14" Margin="10,0,0,0"/>
                            <TextBox Grid.Row="1" Text="{Binding SettingBDViewModel.PathTemporaryData}" Style="{StaticResource defaultTextBox}" Margin="10,0,10,10"/>
                        </Grid>

                        <StackPanel Grid.Row="6" Background="White" Margin="10" Orientation="Horizontal" HorizontalAlignment="Right">
                            <StackPanel.Effect>
                                <DropShadowEffect Opacity="0.3" ShadowDepth="1"/>
                            </StackPanel.Effect>

                            <Button Content="/Common/Images/saveConfig.png" Style="{StaticResource ButtonImage}" Command="{Binding SettingBDViewModel.SaveConfigCommand}"
                                    Height="23" Width="23" VerticalAlignment="Top" Margin="10" ToolTip="Сохранить настройки конфигурации"/>

                            <Button Content="/Common/Images/removeConfig.png" Style="{StaticResource ButtonImage}" Command="{Binding SettingBDViewModel.RemoveConfigCommand}"
                                    Height="23" Width="23" VerticalAlignment="Top" Margin="10" ToolTip="Удалить настройки конфигурации"/>

                            <Button Content="/Common/Images/createBaseData.png" Style="{StaticResource ButtonImage}" Command="{Binding SettingBDViewModel.CreateISCommand}"
                                    Height="23" Width="23" VerticalAlignment="Top" Margin="10" ToolTip="Удалить настройки конфигурации"/>
                            
                        </StackPanel>

                    </Grid>
                </Expander>
                
            </Grid>
        </ScrollViewer>

    </Grid>
    
</UserControl>
